cmake_minimum_required(VERSION 3.16)
project(TestUniqueDirections VERSION 1.0.0)

# Set C++ standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find required packages
find_package(PkgConfig REQUIRED)

# nlohmann/json
find_package(nlohmann_json QUIET)
if(NOT nlohmann_json_FOUND)
    message(STATUS "nlohmann/json not found via find_package, checking for manual installation")
    find_path(NLOHMANN_JSON_INCLUDE_DIR nlohmann/json.hpp PATHS /usr/local/include /usr/include)
    if(NOT NLOHMANN_JSON_INCLUDE_DIR)
        message(FATAL_ERROR "nlohmann/json not found. Please install nlohmann/json library.")
    endif()
endif()

# Include directories
if(NLOHMANN_JSON_INCLUDE_DIR)
    include_directories(${NLOHMANN_JSON_INCLUDE_DIR})
endif()

# Add test executable
add_executable(test_unique_directions test_unique_directions.cpp src/challenge_generator.cpp)

# Link libraries
if(nlohmann_json_FOUND)
    target_link_libraries(test_unique_directions nlohmann_json::nlohmann_json)
endif()

# Compiler options
if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
    target_compile_options(test_unique_directions PRIVATE -Wall -Wextra)
elseif(CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
    target_compile_options(test_unique_directions PRIVATE -Wall -Wextra)
endif()
